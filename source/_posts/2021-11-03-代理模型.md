---
title:代理模型
date:2021-11-0310:44:23
tags:
mathjax:true
typora-root-url:..
---

### 代理模型简介

代理模型是复杂工程优化设计问题的关键技术之一。许多复杂问题的优化方法，如遗传算法、模拟退火算法、粒子群算法和蚁群算法等等。与传统的基于梯度的优化方法比，上述这些算法具有很好的鲁棒性、全局性和高度并行性等特点，在多峰值的非线性函数优化问题中得到了成功的应用。但是这些算法的最大缺点是收敛速度慢，需要对目标函数进行大量的评估，如果目标函数评估方法比较耗时(如工程优化中的CFD和FEM分析)，则计算量很大，严重制约了其在工程中的应用。为了克服全局优化算法的这个缺点，人们采用了一种称为代理模型(surrogate model)的方法来代替耗时的精确模型评估。代理模型的计算量比精确模型小得多，同时精度也可以得到保证，采用代理模型可以大大减少优化过程的计算量，提高工程优化设计的效率。常用的代理模型主要包括**多项式响应面模型**、**人工神经元网络模型**、**径向基函数模型**及**Kriging模型**等。其中Kriging模型具有训练样本点处无偏估计、良好的高度非线性近似能力，非常适合作为代理模型使用。目前Kriging模型在工程优化设计领域得到了广泛应用。[1]

#### 1. 多项式响应面模型

也称作响应曲面设计方法(Response Surface Methodology，RSM)，是通过一系列多变量试验，通过回归方程来模拟真实状态曲面的方法。一般情况下，二次回归方程可以给出较为满意的答案，即
$$
y=\beta_{0}+\sum_{i=1}^{m} \beta_{i} x_{i}+\sum_{i=1}^{m} \beta_{i i} x_{i} x_{i}+\sum \sum_{i<j} \beta_{i j} x_{i} x_{j}+\varepsilon
$$
写成更紧凑的形式：
$$
y_{i}=\beta_{0}+\sum_{j=1}^{k} \beta_{j} x_{i j}+\varepsilon_{i} \quad i=1,2, \ldots, n
$$
多次观测后写成矩阵形式为：
$$
\mathbf{y}=\mathbf{X} \boldsymbol{\beta}+\boldsymbol{\varepsilon}
$$
其中
$$
\begin{gathered}
\mathbf{y}=\left[\begin{array}{c}
y_{1} \\
y_{2} \\
\vdots \\
y_{n}
\end{array}\right], \mathbf{X}=\left[\begin{array}{ccccc}
1 & x_{11} & x_{12} & \ldots & x_{1 k} \\
1 & x_{21} & x_{22} & \ldots & x_{2 k} \\
\vdots & \vdots & \vdots & \vdots & \vdots \\
1 & x_{n 1} & x_{n 2} & \ldots & x_{n k}
\end{array}\right], \\

\boldsymbol{\beta}=\left[\begin{array}{c}
\beta_{0} \\
\beta_{1} \\
\vdots \\
\beta_{k}
\end{array}\right],\boldsymbol{\varepsilon}=\left[\begin{array}{c}
\varepsilon_{0} \\
\varepsilon_{1} \\
\vdots \\
\varepsilon_{k}
\end{array}\right]
\end{gathered}
$$


观测误差方差为
$$
\mathbf{L}=\sum_{i=1}^{n} \varepsilon_{i}^{2}=\boldsymbol{\varepsilon}^{\prime} \boldsymbol{\varepsilon}=(\mathbf{y}-\mathbf{X} \boldsymbol{\beta})^{\prime}(\mathbf{y}-\mathbf{X} \boldsymbol{\beta})
$$
当方差最小时，显然拟合曲面和实际值最接近，此时
$$
\left.\frac{\partial \mathbf{L}}{\partial \boldsymbol{\beta}}\right|_{\hat{\beta}}=-2 \mathbf{X}^{\prime} \mathbf{y}+2 \mathbf{X}^{\prime} \mathbf{X} \hat{\boldsymbol{\beta}}=0
$$

$$
\hat{\boldsymbol{\beta}}=\left(\mathbf{X}^{\prime} \mathbf{X}\right)^{-1} \mathbf{X}^{\prime} \mathbf{y}
$$

$$
\hat{\mathbf{y}}=\mathbf{X} \hat{\boldsymbol{\beta}}
$$







[1]王红涛,竺晓程,杜朝辉.基于Kriging代理模型的改进EGO算法研究[J].工程设计学报,2009,16(04):266-270+302.

[2]张建侠. 基于Kriging模型的全局代理优化算法研究[D].南京理工大学,2018.



